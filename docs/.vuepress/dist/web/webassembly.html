<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>写一个WebAssembly/wasm包 | Dragon的博客</title><meta name="description" content="Dragon的博客">
    <link rel="modulepreload" href="/assets/app.6f701442.js"><link rel="modulepreload" href="/assets/webassembly.html.7d77eb43.js"><link rel="modulepreload" href="/assets/webassembly.html.1d989195.js"><link rel="prefetch" href="/assets/index.html.1c9c3412.js"><link rel="prefetch" href="/assets/springboot.html.12389ff2.js"><link rel="prefetch" href="/assets/fractal.html.e828b479.js"><link rel="prefetch" href="/assets/matrixAndTransform.html.28059e9e.js"><link rel="prefetch" href="/assets/apply.html.28e5775c.js"><link rel="prefetch" href="/assets/assign.html.2be7c456.js"><link rel="prefetch" href="/assets/bind.html.c475086f.js"><link rel="prefetch" href="/assets/class.html.d209faa3.js"><link rel="prefetch" href="/assets/equal.html.7d66c200.js"><link rel="prefetch" href="/assets/event.html.808bc2b2.js"><link rel="prefetch" href="/assets/function.html.6ecdaa64.js"><link rel="prefetch" href="/assets/instanceof.html.570a569b.js"><link rel="prefetch" href="/assets/let_var.html.bc27ba03.js"><link rel="prefetch" href="/assets/module.html.0f7b2362.js"><link rel="prefetch" href="/assets/new.html.460266aa.js"><link rel="prefetch" href="/assets/promise1.html.f033c91e.js"><link rel="prefetch" href="/assets/promise2.html.23b8e119.js"><link rel="prefetch" href="/assets/scope.html.7972736c.js"><link rel="prefetch" href="/assets/this.html.cde05b96.js"><link rel="prefetch" href="/assets/http.html.947c2389.js"><link rel="prefetch" href="/assets/tcp_udp.html.36b264f4.js"><link rel="prefetch" href="/assets/cookie和session.html.7cbcdb4a.js"><link rel="prefetch" href="/assets/cors请求.html.ff488a0d.js"><link rel="prefetch" href="/assets/oauth2.0和jwt.html.f9dd3da6.js"><link rel="prefetch" href="/assets/xss与csrf.html.7baefeaf.js"><link rel="prefetch" href="/assets/sort.html.8a275f43.js"><link rel="prefetch" href="/assets/base.html.e69da62f.js"><link rel="prefetch" href="/assets/gymnastics.html.87528ec2.js"><link rel="prefetch" href="/assets/polyfill.html.1411e9c3.js"><link rel="prefetch" href="/assets/tsconfig.html.a6c68a22.js"><link rel="prefetch" href="/assets/babel.html.16e96e69.js"><link rel="prefetch" href="/assets/index.html.e8ab9f79.js"><link rel="prefetch" href="/assets/react-hooks.html.d79be41b.js"><link rel="prefetch" href="/assets/url.html.6cc10f68.js"><link rel="prefetch" href="/assets/vue3.html.b194d42d.js"><link rel="prefetch" href="/assets/webpack1.html.70f93b14.js"><link rel="prefetch" href="/assets/webpack2.html.c264079b.js"><link rel="prefetch" href="/assets/404.html.c3e557d0.js"><link rel="prefetch" href="/assets/index.html.85ce16fe.js"><link rel="prefetch" href="/assets/springboot.html.cc962df4.js"><link rel="prefetch" href="/assets/fractal.html.d75563f0.js"><link rel="prefetch" href="/assets/matrixAndTransform.html.6872511d.js"><link rel="prefetch" href="/assets/apply.html.7360fc93.js"><link rel="prefetch" href="/assets/assign.html.7c0a3f5d.js"><link rel="prefetch" href="/assets/bind.html.553859a9.js"><link rel="prefetch" href="/assets/class.html.98b2737f.js"><link rel="prefetch" href="/assets/equal.html.3fab2c02.js"><link rel="prefetch" href="/assets/event.html.89b2ff35.js"><link rel="prefetch" href="/assets/function.html.3a48fa50.js"><link rel="prefetch" href="/assets/instanceof.html.892b6394.js"><link rel="prefetch" href="/assets/let_var.html.982b2a91.js"><link rel="prefetch" href="/assets/module.html.fe5c7c55.js"><link rel="prefetch" href="/assets/new.html.55e5d352.js"><link rel="prefetch" href="/assets/promise1.html.dd7c44aa.js"><link rel="prefetch" href="/assets/promise2.html.56092450.js"><link rel="prefetch" href="/assets/scope.html.65b450ad.js"><link rel="prefetch" href="/assets/this.html.234bf427.js"><link rel="prefetch" href="/assets/http.html.9ddd828c.js"><link rel="prefetch" href="/assets/tcp_udp.html.6c360a53.js"><link rel="prefetch" href="/assets/cookie和session.html.bcff6685.js"><link rel="prefetch" href="/assets/cors请求.html.b039b119.js"><link rel="prefetch" href="/assets/oauth2.0和jwt.html.ecd10675.js"><link rel="prefetch" href="/assets/xss与csrf.html.36c157dd.js"><link rel="prefetch" href="/assets/sort.html.44f6a59e.js"><link rel="prefetch" href="/assets/base.html.151f817b.js"><link rel="prefetch" href="/assets/gymnastics.html.dfdbdd22.js"><link rel="prefetch" href="/assets/polyfill.html.0b7deb29.js"><link rel="prefetch" href="/assets/tsconfig.html.0d252eaa.js"><link rel="prefetch" href="/assets/babel.html.271420fd.js"><link rel="prefetch" href="/assets/index.html.b995a229.js"><link rel="prefetch" href="/assets/react-hooks.html.6f8c6c02.js"><link rel="prefetch" href="/assets/url.html.bbb6a214.js"><link rel="prefetch" href="/assets/vue3.html.755a7056.js"><link rel="prefetch" href="/assets/webpack1.html.d07ba7fd.js"><link rel="prefetch" href="/assets/webpack2.html.c47c5738.js"><link rel="prefetch" href="/assets/404.html.4b8d0d14.js">
    <link rel="stylesheet" href="/assets/style.8adf15a0.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Dragon的博客</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">javascript <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/js/event.html" class="sidebar-item" aria-label="事件循环机制/Event loop"><!--[--><!--]--> 事件循环机制/Event loop <!--[--><!--]--></a><!----></li><li><a href="/js/function.html" class="sidebar-item" aria-label="函数"><!--[--><!--]--> 函数 <!--[--><!--]--></a><!----></li><li><a href="/js/module.html" class="sidebar-item" aria-label="CommonJS、AMD、CMD、ESM、UMD"><!--[--><!--]--> CommonJS、AMD、CMD、ESM、UMD <!--[--><!--]--></a><!----></li><li><a href="/js/promise1.html" class="sidebar-item" aria-label="Promise--上"><!--[--><!--]--> Promise--上 <!--[--><!--]--></a><!----></li><li><a href="/js/promise2.html" class="sidebar-item" aria-label="Promise--下"><!--[--><!--]--> Promise--下 <!--[--><!--]--></a><!----></li><li><a href="/js/scope.html" class="sidebar-item" aria-label="作用域"><!--[--><!--]--> 作用域 <!--[--><!--]--></a><!----></li><li><a href="/js/class.html" class="sidebar-item" aria-label="类"><!--[--><!--]--> 类 <!--[--><!--]--></a><!----></li><li><a href="/js/new.html" class="sidebar-item" aria-label="new"><!--[--><!--]--> new <!--[--><!--]--></a><!----></li><li><a href="/js/let,var.html" class="sidebar-item" aria-label="let和var"><!--[--><!--]--> let和var <!--[--><!--]--></a><!----></li><li><a href="/js/this.html" class="sidebar-item" aria-label="this"><!--[--><!--]--> this <!--[--><!--]--></a><!----></li><li><a href="/js/bind.html" class="sidebar-item" aria-label="bind"><!--[--><!--]--> bind <!--[--><!--]--></a><!----></li><li><a href="/js/apply.html" class="sidebar-item" aria-label="call、apply"><!--[--><!--]--> call、apply <!--[--><!--]--></a><!----></li><li><a href="/js/equal.html" class="sidebar-item" aria-label="隐式转换 == 和 ==="><!--[--><!--]--> 隐式转换 == 和 === <!--[--><!--]--></a><!----></li><li><a href="/js/assign.html" class="sidebar-item" aria-label="Object.assign和...（展开运算符/扩展运算符）的区别 [已发帖]"><!--[--><!--]--> Object.assign和...（展开运算符/扩展运算符）的区别 [已发帖] <!--[--><!--]--></a><!----></li><li><a href="/js/instanceof.html" class="sidebar-item" aria-label="instanceof [已发帖]"><!--[--><!--]--> instanceof [已发帖] <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">typescript <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/typescript/tsconfig.html" class="sidebar-item" aria-label="tsconfig.json配置"><!--[--><!--]--> tsconfig.json配置 <!--[--><!--]--></a><!----></li><li><a href="/typescript/base.html" class="sidebar-item" aria-label="typescript基础"><!--[--><!--]--> typescript基础 <!--[--><!--]--></a><!----></li><li><a href="/typescript/polyfill.html" class="sidebar-item" aria-label="工具类的模拟实现"><!--[--><!--]--> 工具类的模拟实现 <!--[--><!--]--></a><!----></li><li><a href="/typescript/gymnastics.html" class="sidebar-item" aria-label="ts类型体操训练"><!--[--><!--]--> ts类型体操训练 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">前端相关 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/web/" class="router-link-active sidebar-item" aria-label="索引"><!--[--><!--]--> 索引 <!--[--><!--]--></a><!----></li><li><a href="/web/webpack1.html" class="sidebar-item" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a><!----></li><li><a href="/web/webpack2.html" class="sidebar-item" aria-label="webpack 和 vite"><!--[--><!--]--> webpack 和 vite <!--[--><!--]--></a><!----></li><li><a href="/web/url.html" class="sidebar-item" aria-label="浏览器从输入url发生了什么[未完...]"><!--[--><!--]--> 浏览器从输入url发生了什么[未完...] <!--[--><!--]--></a><!----></li><li><a href="/web/babel.html" class="sidebar-item" aria-label="babel"><!--[--><!--]--> babel <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web/webassembly.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="写一个WebAssembly/wasm包"><!--[--><!--]--> 写一个WebAssembly/wasm包 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/web/webassembly.html#简介" class="router-link-active router-link-exact-active sidebar-item" aria-label="简介"><!--[--><!--]--> 简介 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web/webassembly.html#配置rust镜像" class="router-link-active router-link-exact-active sidebar-item" aria-label="配置rust镜像"><!--[--><!--]--> 配置rust镜像 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web/webassembly.html#创建项目" class="router-link-active router-link-exact-active sidebar-item" aria-label="创建项目"><!--[--><!--]--> 创建项目 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web/webassembly.html#使用wasm" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用wasm"><!--[--><!--]--> 使用wasm <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/web/webassembly.html#以npm包的方式使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="以npm包的方式使用"><!--[--><!--]--> 以npm包的方式使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web/webassembly.html#wasm的npm包使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="wasm的npm包使用"><!--[--><!--]--> wasm的npm包使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web/webassembly.html#以http的方式直接引入" class="router-link-active router-link-exact-active sidebar-item" aria-label="以http的方式直接引入"><!--[--><!--]--> 以http的方式直接引入 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web/webassembly.html#把c编译为wasm" class="router-link-active router-link-exact-active sidebar-item" aria-label="把c编译为wasm"><!--[--><!--]--> 把c编译为wasm <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web/webassembly.html#把c-编译为wasm" class="router-link-active router-link-exact-active sidebar-item" aria-label="把c++编译为wasm"><!--[--><!--]--> 把c++编译为wasm <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/web/webassembly.html#参考" class="router-link-active router-link-exact-active sidebar-item" aria-label="参考"><!--[--><!--]--> 参考 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/web/vue3.html" class="sidebar-item" aria-label="vue3源码[未完...]"><!--[--><!--]--> vue3源码[未完...] <!--[--><!--]--></a><!----></li><li><a href="/web/react-hooks.html" class="sidebar-item" aria-label="React Hooks源码"><!--[--><!--]--> React Hooks源码 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">web安全相关 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/security/xss%E4%B8%8Ecsrf.html" class="sidebar-item" aria-label="XSS和CSRF"><!--[--><!--]--> XSS和CSRF <!--[--><!--]--></a><!----></li><li><a href="/security/cors%E8%AF%B7%E6%B1%82.html" class="sidebar-item" aria-label="跨域请求"><!--[--><!--]--> 跨域请求 <!--[--><!--]--></a><!----></li><li><a href="/security/cookie%E5%92%8Csession.html" class="sidebar-item" aria-label="cookie 和 session"><!--[--><!--]--> cookie 和 session <!--[--><!--]--></a><!----></li><li><a href="/security/oauth2.0%E5%92%8Cjwt.html" class="sidebar-item" aria-label="OAuth2.0和JWT"><!--[--><!--]--> OAuth2.0和JWT <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">计算机网络相关 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/network/http.html" class="sidebar-item" aria-label="http"><!--[--><!--]--> http <!--[--><!--]--></a><!----></li><li><a href="/network/tcp,udp.html" class="sidebar-item" aria-label="TCP/UDP"><!--[--><!--]--> TCP/UDP <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">java <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/java/springboot.html" class="sidebar-item" aria-label="springboot"><!--[--><!--]--> springboot <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">计算机图形学 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/graphics/fractal.html" class="sidebar-item" aria-label="分形图形"><!--[--><!--]--> 分形图形 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="写一个webassembly-wasm包" tabindex="-1"><a class="header-anchor" href="#写一个webassembly-wasm包" aria-hidden="true">#</a> 写一个WebAssembly/wasm包</h1><!----><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><p>WebAssembly 是一种新的编码方式，可以在现代的网络浏览器中运行 － 它是一种低级的类汇编语言，具有紧凑的二进制格式，可以接近原生的性能运行，并为诸如 Rust/ C / C ++ / Go等语言提供一个编译目标，以便它们可以在 Web 上运行。它也被设计为可以与 JavaScript 共存，允许两者一起工作。</p><p>本篇文章，会讲述如何创建一个webAssembly的npm包和如何在项目中使用*.wasm文件。</p><h2 id="配置rust镜像" tabindex="-1"><a class="header-anchor" href="#配置rust镜像" aria-hidden="true">#</a> 配置rust镜像</h2><p>要是没翻墙，容易下载包之类的失败。所以要配置镜像</p><p>将下面的内容复制保存成config（无后缀） 放在.cargo文件夹下面，或者在项目文件夹与.toml文件同级目录里新建一个.cargo文件夹，放在里面</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">config文件</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>source.crates-io<span class="token punctuation">]</span>
<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token string">&quot;https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="token comment">#指定镜像</span>
<span class="token comment">#如：tuna、sjtu、ustc，或者 rustcc</span>
replace-with<span class="token operator">=</span><span class="token string">&#39;tuna&#39;</span>

<span class="token comment">#注：以下源配置一个即可，无需全部</span>

<span class="token comment">#中国科学技术大学</span>
<span class="token punctuation">[</span>source.ustc<span class="token punctuation">]</span>
<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token string">&quot;https://mirrors.ustc.edu.cn/crates.io-index&quot;</span>

<span class="token comment">#上海交通大学</span>
<span class="token punctuation">[</span>source.sjtu<span class="token punctuation">]</span>
<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token string">&quot;https://mirrors.sjtug.sjtu.edu.cn/git/crates.io-index/&quot;</span>

<span class="token comment">#清华大学</span>
<span class="token punctuation">[</span>source.tuna<span class="token punctuation">]</span>
<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token string">&quot;https://mirrors.tuna.tsinghua.edu.cn/git/crates.io-index.git&quot;</span>

<span class="token comment">#rustcc社区</span>
<span class="token punctuation">[</span>source.rustcc<span class="token punctuation">]</span>
<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token string">&quot;https://code.aliyun.com/rustcc/crates.io-index.git&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>我的是在</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>qaq@MacBook-Pro tree <span class="token parameter variable">-L</span> <span class="token number">1</span>
<span class="token builtin class-name">.</span>
├── bin
├── config    <span class="token operator">&lt;</span>----- 创建这么一个文件
├── <span class="token function">env</span>
├── <span class="token function">git</span>
└── registry
qaq@MacBook-Pro .cargo % <span class="token builtin class-name">pwd</span>
/Users/qaq/.cargo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="创建项目" tabindex="-1"><a class="header-anchor" href="#创建项目" aria-hidden="true">#</a> 创建项目</h2><p>目标是实现一个wasm版本的，斐波那契数列的第n项。（递归方式实现！）</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">foo</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">foo</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">)</span> <span class="token comment">// 返回第43个斐波那契数列的值</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行rust的cargo</p><blockquote><p>cargo install wasm-pack</p></blockquote><blockquote><p>cargo new --lib web-fib</p></blockquote><p>创建完成后的项目结构</p><div class="language-txt ext-txt line-numbers-mode"><pre class="language-txt"><code>.
├── Cargo.lock
├── Cargo.toml
├── src
│   └── lib.rs
└── target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在Cargo.toml里添加如下高亮的代码块。</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Cargo.toml</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-toml ext-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">package</span><span class="token punctuation">]</span>
<span class="token key property">name</span> <span class="token punctuation">=</span> <span class="token string">&quot;web-fib&quot;</span>
<span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.1.0&quot;</span>
<span class="token key property">edition</span> <span class="token punctuation">=</span> <span class="token string">&quot;2021&quot;</span>

<span class="token punctuation">[</span><span class="token table class-name">lib</span><span class="token punctuation">]</span>
<span class="token key property">crate-type</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;cdylib&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;rlib&quot;</span><span class="token punctuation">]</span>

<span class="token comment"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span>

<span class="token punctuation">[</span><span class="token table class-name">dependencies</span><span class="token punctuation">]</span>
<span class="token key property">wasm-bindgen</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.2.63&quot;</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><div class="highlight-line"> </div></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>修改src下的lib.rs为：</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">lib.rs</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">wasm_bindgen<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[wasm_bindgen]</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">fib</span><span class="token punctuation">(</span>v<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span> <span class="token comment">// rust递归实现斐波那契数列第n项</span>
    <span class="token keyword">match</span> v <span class="token punctuation">{</span>
        <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token number">2</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token function">fib</span><span class="token punctuation">(</span>v <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fib</span><span class="token punctuation">(</span>v <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>然后运行</p><blockquote><p>warm-pack build</p></blockquote><p>这时候就会多一个目录pkg，这个pkg就是我们的npm包</p><div class="language-txt ext-txt line-numbers-mode"><pre class="language-txt"><code>.
├── Cargo.lock
├── Cargo.toml
├── pkg
│   ├── package.json
│   ├── web_fib.d.ts
│   ├── web_fib.js
│   ├── web_fib_bg.js
│   ├── web_fib_bg.wasm
│   └── web_fib_bg.wasm.d.ts
├── src
│   └── lib.rs
└── target
    ├── CACHEDIR.TAG
    ├── debug
    ├── release
    └── wasm32-unknown-unknown
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>wasm文件在浏览器的preview</p><div class="language-wasm ext-wasm line-numbers-mode"><pre class="language-wasm"><code><span class="token punctuation">(</span><span class="token keyword">module</span>
  <span class="token punctuation">(</span><span class="token keyword">memory</span> $<span class="token keyword">memory</span> <span class="token comment">(;0;)</span> <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">&quot;memory&quot;</span><span class="token punctuation">)</span> <span class="token number">17</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token variable">$func0</span> <span class="token punctuation">(</span><span class="token keyword">param</span> <span class="token variable">$var0</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">result</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">local</span> <span class="token variable">$var1</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1</span>
    <span class="token keyword">local</span>.set <span class="token variable">$var1</span>
    <span class="token keyword">local</span>.get <span class="token variable">$var0</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">-1</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>add</span>
    <span class="token keyword">local</span>.tee <span class="token variable">$var0</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">2</span>
    <span class="token keyword">i32<span class="token punctuation">.</span>ge_u</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">result</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">0</span>
      <span class="token keyword">local</span>.set <span class="token variable">$var1</span>
      <span class="token keyword">loop</span> <span class="token variable">$label0</span>
        <span class="token keyword">local</span>.get <span class="token variable">$var0</span>
        <span class="token keyword">call</span> <span class="token variable">$func0</span>
        <span class="token keyword">local</span>.get <span class="token variable">$var1</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>add</span>
        <span class="token keyword">local</span>.set <span class="token variable">$var1</span>
        <span class="token keyword">local</span>.get <span class="token variable">$var0</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">-2</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>add</span>
        <span class="token keyword">local</span>.tee <span class="token variable">$var0</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1</span>
        <span class="token keyword">i32<span class="token punctuation">.</span>gt_u</span>
        <span class="token keyword">br_if</span> <span class="token variable">$label0</span>
      <span class="token keyword">end</span> <span class="token variable">$label0</span>
      <span class="token keyword">local</span>.get <span class="token variable">$var1</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1</span>
      <span class="token keyword">i32<span class="token punctuation">.</span>add</span>
    <span class="token keyword">else</span>
      <span class="token keyword">local</span>.get <span class="token variable">$var1</span>
    <span class="token keyword">end</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">func</span> <span class="token variable">$fib</span> <span class="token comment">(;1;)</span> <span class="token punctuation">(</span><span class="token keyword">export</span> <span class="token string">&quot;fib&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">param</span> <span class="token variable">$var0</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">result</span> <span class="token keyword">i32</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span>.get <span class="token variable">$var0</span>
    <span class="token keyword">call</span> <span class="token variable">$func0</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">data</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1048576</span><span class="token punctuation">)</span> <span class="token string">&quot;\04&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="使用wasm" tabindex="-1"><a class="header-anchor" href="#使用wasm" aria-hidden="true">#</a> 使用wasm</h2><h3 id="以npm包的方式使用" tabindex="-1"><a class="header-anchor" href="#以npm包的方式使用" aria-hidden="true">#</a> 以npm包的方式使用</h3><p>我们在package.json里添加npm包。(这里是npm引入未发布的本地npm的包，可以直接用路径)。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wasm-test&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;private&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tsc &amp;&amp; vite build&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;preview&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite preview&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;react&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^18.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;react-dom&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^18.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;web-fib&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file:/Users/dragon/workspace/rust/work/web-ffmpeg/pkg&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@types/react&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^18.0.17&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@types/react-dom&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^18.0.6&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vitejs/plugin-react&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;typescript&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.6.4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vite&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.1.0&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后执行</p><blockquote><p>npm install</p></blockquote><h3 id="wasm的npm包使用" tabindex="-1"><a class="header-anchor" href="#wasm的npm包使用" aria-hidden="true">#</a> wasm的npm包使用</h3><p>vite中使用</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> init <span class="token keyword">from</span> <span class="token string">&quot;../node_modules/web-fib/web_fib_bg.wasm?init&quot;</span><span class="token punctuation">;</span>

<span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;通过调用wasm计算fib(43)&#39;</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function">fib</span><span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>webpack5中使用</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> wasm <span class="token keyword">from</span> <span class="token string">&quot;web-fib&quot;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;通过调用wasm计算fib(43)&#39;</span><span class="token punctuation">,</span> wasm<span class="token punctuation">.</span><span class="token function">fib</span><span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container danger"><p class="custom-container-title">提示</p><p>这样使用的话，需要配置webpack5，这是个实验性功能。或者可以使用wasm-loader，或者参考<a href="#%E4%BB%A5http%E7%9A%84%E6%96%B9%E5%BC%8F%E7%9B%B4%E6%8E%A5%E5%BC%95%E5%85%A5">以http的方式直接引入</a>的js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">experiments</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">asyncWebAssembly</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="以http的方式直接引入" tabindex="-1"><a class="header-anchor" href="#以http的方式直接引入" aria-hidden="true">#</a> 以http的方式直接引入</h3><p>先把pkg/web_fib_bg.wasm放到服务器上，给到一个http://xxx.xxx.xxx/web_fib_bg.wasm的连接</p><p>test.html的代码</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>WebAssembly<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">function</span> <span class="token function">loadWebAssembly</span><span class="token punctuation">(</span><span class="token parameter">fileName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;cors&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//加载字节码</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">bits</span> <span class="token operator">=&gt;</span> WebAssembly<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>bits<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//编译字节码</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">module</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WebAssembly<span class="token punctuation">.</span>Instance</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//实例化</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">loadWebAssembly</span><span class="token punctuation">(</span><span class="token string">&#39;http://xxx.xxx.xxx/web_fib_bg.wasm&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 你的web_fib_bg.wasm的文件地址</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">instance</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$wasmModule <span class="token operator">=</span> instance<span class="token punctuation">.</span>exports<span class="token punctuation">;</span> <span class="token comment">//将instanc暴露在全局变量中以供js调用</span>
  fib <span class="token operator">=</span> instance<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>fib<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;通过调用wasm计算fib(43)&#39;</span><span class="token punctuation">,</span> <span class="token function">fib</span><span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">loadWebAssembly</span><span class="token punctuation">(</span>
  fileName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  imports<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span> env<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>WebAssembly<span class="token punctuation">.</span>WebAssemblyInstantiatedSource<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// return fetch(fileName, { mode: &quot;cors&quot; })</span>
  <span class="token comment">//   .then((response) =&gt; response.arrayBuffer())</span>
  <span class="token comment">//   .then((bits) =&gt; WebAssembly.compile(bits))</span>
  <span class="token comment">//   .then((module) =&gt; {</span>
  <span class="token comment">//     return new WebAssembly.Instance(module);</span>
  <span class="token comment">//   });</span>

  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token punctuation">{</span> mode<span class="token operator">:</span> <span class="token string">&quot;cors&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      imports<span class="token punctuation">.</span>env <span class="token operator">=</span> imports<span class="token punctuation">.</span>env <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>imports<span class="token punctuation">.</span>env<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        memoryBase<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        tableBase<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        __memory_base<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        __table_base<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        memory<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">WebAssembly</span><span class="token punctuation">.</span><span class="token function">Memory</span><span class="token punctuation">(</span><span class="token punctuation">{</span> initial<span class="token operator">:</span> <span class="token number">256</span><span class="token punctuation">,</span> maximum<span class="token operator">:</span> <span class="token number">256</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        table<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">WebAssembly</span><span class="token punctuation">.</span><span class="token function">Table</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          initial<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          maximum<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          element<span class="token operator">:</span> <span class="token string">&quot;anyfunc&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> WebAssembly<span class="token punctuation">.</span><span class="token function">instantiate</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> imports<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="把c编译为wasm" tabindex="-1"><a class="header-anchor" href="#把c编译为wasm" aria-hidden="true">#</a> 把c编译为wasm</h3><p>创建如下内容的文件</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">fib</span> <span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">fib</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fib</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装<a href="https://github.com/emscripten-core/emscripten" target="_blank" rel="noopener noreferrer">emscripten<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>然后运行</p><blockquote><p>emcc --no-entry fib.c -s EXPORTED_FUNCTIONS=&#39;[&quot;_fib&quot;]&#39; -o fib.wasm</p></blockquote><p>得到fib.wasm就可以如上一样使用</p><h3 id="把c-编译为wasm" tabindex="-1"><a class="header-anchor" href="#把c-编译为wasm" aria-hidden="true">#</a> 把c++编译为wasm</h3><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">EM_PORT_API</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>	<span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>__EMSCRIPTEN__<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span>		<span class="token directive keyword">include</span> <span class="token string">&lt;emscripten.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>		<span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>__cplusplus<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span>			<span class="token directive keyword">define</span> <span class="token macro-name function">EM_PORT_API</span><span class="token expression"><span class="token punctuation">(</span>rettype<span class="token punctuation">)</span> <span class="token keyword">extern</span> </span><span class="token string">&quot;C&quot;</span> <span class="token expression">rettype EMSCRIPTEN_KEEPALIVE</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>		<span class="token directive keyword">else</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>			<span class="token directive keyword">define</span> <span class="token macro-name function">EM_PORT_API</span><span class="token expression"><span class="token punctuation">(</span>rettype<span class="token punctuation">)</span> rettype EMSCRIPTEN_KEEPALIVE</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>		<span class="token directive keyword">endif</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>	<span class="token directive keyword">else</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>		<span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>__cplusplus<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span>			<span class="token directive keyword">define</span> <span class="token macro-name function">EM_PORT_API</span><span class="token expression"><span class="token punctuation">(</span>rettype<span class="token punctuation">)</span> <span class="token keyword">extern</span> </span><span class="token string">&quot;C&quot;</span> <span class="token expression">rettype</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>		<span class="token directive keyword">else</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>			<span class="token directive keyword">define</span> <span class="token macro-name function">EM_PORT_API</span><span class="token expression"><span class="token punctuation">(</span>rettype<span class="token punctuation">)</span> rettype</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>		<span class="token directive keyword">endif</span></span>
<span class="token macro property"><span class="token directive-hash">#</span>	<span class="token directive keyword">endif</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token function">EM_PORT_API</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token function">fib</span> <span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">fib</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fib</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>c++导出fib函数需要定义<code>函数导出宏</code>，不然会报错</p><blockquote><p>emcc --no-entry ./fib.cc -s EXPORTED_FUNCTIONS=_fib -o fib.wasm</p></blockquote><p>如果不定义的话需要这样，但是函数全部导出，不写就莫得fib函数，<code>emcc --help</code>可以看见一些优化项</p><blockquote><p>emcc ./fib.cc -Wl,--export-all -o fib.wasm</p></blockquote><p>得到fib.wasm就可以如上一样使用</p><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2><ul><li><a href="https://webassembly.org/" target="_blank" rel="noopener noreferrer">WebAssembly 官网<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/WebAssembly" target="_blank" rel="noopener noreferrer">WebAssembly MDN<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://doc.rust-lang.org/book/title-page.html" target="_blank" rel="noopener noreferrer">The Rust Programming Language<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://doc.rust-lang.org/stable/reference/introduction.html" target="_blank" rel="noopener noreferrer">The Rust Reference<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://rustwasm.github.io/docs/wasm-bindgen/" target="_blank" rel="noopener noreferrer">关于wasm-bindgen<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/web/babel.html" class="" aria-label="babel"><!--[--><!--]--> babel <!--[--><!--]--></a></span><span class="next"><a href="/web/vue3.html" class="" aria-label="vue3源码[未完...]"><!--[--><!--]--> vue3源码[未完...] <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.6f701442.js" defer></script>
  </body>
</html>
